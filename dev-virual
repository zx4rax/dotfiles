#!/bin/bash

# Colors for output
GREEN='\033[0;32m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

echo -e "${BLUE}[*] Starting VPS setup script...${NC}"

# Function to print status messages
print_status() {
    echo -e "${GREEN}[*] $1${NC}"
}

# Update system and install basic tools
print_status "Updating system and installing basic packages..."
apt update && apt upgrade -y
apt install -y \
    git \
    curl \
    wget \
    make \
    gcc \
    proxychains4 \
    unzip \
    python3 \
    python3-pip \
    python3-venv \
    python3-dev \
    python3-setuptools \
    python3-wheel 


# Install Go
print_status "Installing Go..."
wget https://go.dev/dl/go1.21.6.linux-amd64.tar.gz
rm -rf /usr/local/go && tar -C /usr/local -xzf go1.21.6.linux-amd64.tar.gz
rm go1.21.6.linux-amd64.tar.gz

# Set up Go environment
echo 'export GOPATH=$HOME/go' >> ~/.bashrc
echo 'export GOROOT=/usr/local/go' >> ~/.bashrc
echo 'export PATH=$PATH:$GOROOT/bin:$GOPATH/bin' >> ~/.bashrc
source ~/.bashrc

# Install security tools
print_status "Installing subfinder..."
go install -v github.com/projectdiscovery/subfinder/v2/cmd/subfinder@latest

print_status "Installing httpx..."
go install -v github.com/projectdiscovery/httpx/cmd/httpx@latest

print_status "Installing nuclei..."
go install -v github.com/projectdiscovery/nuclei/v2/cmd/nuclei@latest

print_status "Installing dnsx..."
go install -v github.com/projectdiscovery/dnsx/cmd/dnsx@latest

print_status "Installing gf..."
go install -v github.com/tomnomnom/gf@latest


print_status "Installing loxs..."
git clone https://github.com/coffinxp/loxs.git
cd loxs
pip3 install -r requirements.txt --break-system-packages






# Basic security configurations
#print_status "Setting up basic security configurations..."

# Update SSH configuration
#sed -i 's/#PermitRootLogin yes/PermitRootLogin no/' /etc/ssh/sshd_config
#sed -i 's/#PasswordAuthentication yes/PasswordAuthentication no/' /etc/ssh/sshd_config
#systemctl restart sshd

# Set up UFW firewall
#apt-get install -y ufw
#ufw default deny incoming
#ufw default allow outgoing
#ufw allow ssh
#ufw --force enable

# Create a new non-root user (uncomment and modify if needed)
# read -p "Enter username for new user: " username
# useradd -m -s /bin/bash "$username"
# usermod -aG sudo "$username"

print_status "Installation completed!"
#print_status "Please log out and log back in for all changes to take effect."
#print_status "Remember to:"
#echo "1. Change default passwords"
#echo "2. Configure your SSH keys"
#echo "3. Update /etc/proxychains4.conf if needed"
#echo "4. Consider setting up fail2ban for additional security"